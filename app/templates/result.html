<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% if title %}
    <title>{{ title }} - web to email</title>
    {% else %}
    <title>Welcome to web to email converter</title>
    {% endif %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <link rel="stylesheet" href="/static/style.css">
    <script>
        var code = 0;

        function escapeHtml(str) {
            var div = document.createElement('div');
            div.appendChild(document.createTextNode(str));
            return div.innerHTML;
        };

        // UNSAFE with unsafe strings; only use on previously-escaped ones!
        function unescapeHtml(escapedStr) {
            var div = document.createElement('div');
            div.innerHTML = escapedStr;
            var child = div.childNodes[0];
            return child ? child.nodeValue : '';
        };


        $(document).on('click', '.toggle-button', function() {
            $(this).toggleClass('toggle-button-selected');
            if(code == 0){
                var resultDiv = $( "#result" );
                var resultHtml = resultDiv.html();
                resultDiv.empty();

                var textArea = $('<textarea id="textcode"></textarea>');
                resultHtml = escapeHtml(resultHtml);
                textArea.html(resultHtml);

                resultDiv.append(textArea);
                code = 1;
            } else {
                var textcode = $( "#textcode" ).text();
                $( "#result" ).html(textcode);
                code = 0;
            }
        });
    </script>


</head>
<body>
    <div align="center">Web to Email: <a href="/">Home</a></div>
    <hr>
    <div class="button-wrapper centered" align="center">
        Content
        <div class="toggle-button">
            <button></button>
        </div>
        HTML Code
    </div>

    <hr>
    <div id="result">

        <table width="600" cellspacing="0" cellpadding="0" border="0" align="center">
            <tr>
                <td>
                    {% if banner_image %}
                    {{ banner_image | safe }}
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>
                    {% if title %}
                    <h1>{{ title }}</h1>
                    {% endif %}
                </td>
            </tr>
            <tr>
                <td>
                    {{ content | safe }}
                </td>
            </tr>
        </table>
    </div>
</body>
</html>
